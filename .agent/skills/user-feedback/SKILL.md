---
name: user-feedback
description: "用户反馈闭环工作流 — 理解 → 评估 → 实施 → 验证四步流程。当用户以 feedback: 开头时触发。"
compatibility: copilot,opencode,qwen,claude
metadata:
  audience: all-agents
  trigger: "feedback:"
---

# 用户反馈闭环工作流

当用户以 `feedback:` 开头描述建议时，按照 **理解 → 评估 → 实施 → 验证** 四步流程执行。

你需要作为音乐专业人士，评判用户需求是否合理。
如果是已经实现的功能，需要完善帮助页面或示例代码，则直接进入第三步。

---

## 触发条件

用户消息以 `feedback:` 开头：

```
feedback: [简短描述]

[可选] 使用场景 / 期望效果 / 参考案例
```

---

## 第一步：理解需求

**目标**: 明确用户需求和痛点，挖掘真实意图。

**操作**:
1. 分析用户描述的使用场景和期望
2. 识别核心痛点（效率、体验、功能缺失等）
3. 如有歧义，列出可能的理解方式
4. 搜索现有代码，确认功能是否已存在

**输出格式**:
```
## 需求理解

**用户痛点**: 简述当前的问题或不便
**核心诉求**: 用户真正想要的是什么
**使用场景**: 在什么情况下会用到
**是否已存在**: ✅ 已有类似功能 / ❌ 确认缺失
```

---

## 第二步：评估可行性

**操作**:
1. 技术可行性：与现有架构是否兼容
2. 工作量评估：修改范围和复杂度
3. 优先级判断：紧急程度和影响面
4. 潜在风险：可能引入的问题

**输出格式**:
```
## 可行性评估

**技术可行性**: ✅ 容易 / ⚠️ 需要重构 / ❌ 架构不支持
**工作量**: 🟢 简单（<1小时）/ 🟡 中等（1-4小时）/ 🔴 复杂（>4小时）
**优先级**: 🔥 高 / 📌 中 / 💡 低
**建议**: 立即实施 / 延期处理 / 需要讨论 / 不建议
```

---

## 第三步：设计与实施

**操作**:
1. 拆解实施步骤
2. 编写代码，遵循项目规范（参见 `.agent/instructions.md`）
3. 添加单元测试
4. 更新相关文档

**输出格式**:
```
## 实施方案

**涉及文件**: 列出需要修改/新增的文件
**核心改动**: 改动描述
**配套工作**: 测试、文档、示例
```

---

## 第四步：验证与反馈

**操作**:
1. 运行单元测试
2. 检查 TypeScript 错误
3. 验证功能满足核心诉求
4. 评估用户体验

**输出格式**:
```
## 验证结果

- [x/] 单元测试通过
- [x/] 无 TypeScript 错误
- [x/] 核心功能正常
- [x/] 用户体验符合预期

**功能亮点**: 实现的功能和优势
**已知限制**: 当前局限性
**未来改进**: 可优化方向
```

**commit**: `feat: <描述>` 或 `refactor: <描述>`

---

## 关键原则

- **深度理解**：不按字面意思直接实现，挖掘真实需求
- **主动评估**：客观判断可行性和优先级
- **用户视角**：考虑易用性和直观性
- **完整交付**：代码 + 测试 + 文档，三者缺一不可
