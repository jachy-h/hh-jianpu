# 新功能演示指南

## 🎉 v0.1.1 新功能

### 1. 📖 在线帮助文档

#### 功能描述
用户无需离开应用，即可查看完整的简谱编写说明。

#### 使用方法
1. 点击顶部栏右侧的「**❓ 帮助**」按钮
2. 弹出帮助模态框，包含：
   - 🚀 快速入门（三步上手）
   - 📝 完整语法规则（音符、八度、时值、休止符等）
   - 💡 完整示例（小星星、生日快乐等）
   - ❓ 常见问题解答
3. 点击「知道了」或背景区域关闭

#### 设计亮点
- **响应式设计**：自动适配桌面和移动设备
- **清晰排版**：表格化展示语法规则，一目了然
- **颜色编码**：不同类型的内容用不同颜色区分
- **快速查找**：分段落组织，方便定位所需信息

#### 技术实现
- React 模态框组件
- CSS Grid/Flexbox 布局
- Tailwind CSS 样式
- 点击外部自动关闭
- ESC 键支持（可扩展）

---

### 2. 🔧 可拖动分隔线

#### 功能描述
编辑模式下，用户可以通过拖动分隔线自由调整编辑器和预览面板的宽度比例。

#### 使用方法
1. 进入**编辑模式**
2. 将鼠标移动到编辑器和预览面板之间的分隔线
3. 分隔线会高亮显示（蓝色提示）
4. 按住鼠标左键并拖动
5. 松开鼠标完成调整

#### 交互特性
- **悬停反馈**：鼠标悬停时显示蓝色提示线
- **拖动高亮**：拖动时分隔线变为蓝色高亮
- **光标变化**：拖动时全局光标变为 `col-resize`
- **平滑体验**：CSS 过渡动画，流畅自然
- **智能限制**：
  - 左侧最小宽度：300px
  - 右侧最小宽度：300px
  - 防止面板过小影响使用

#### 适用场景
- **宽屏用户**：编辑长篇简谱时，扩大编辑器宽度
- **预览优先**：查看复杂曲谱时，扩大预览面板
- **个性化配置**：根据个人习惯调整布局

#### 技术实现
- React Hooks（useState, useRef, useEffect, useCallback）
- 原生鼠标事件（mousedown, mousemove, mouseup）
- 响应式百分比布局
- 事件监听器自动清理
- 防止文本选中（拖动时 userSelect: none）

#### 设计决策
- **仅桌面设备**：移动设备保持原有响应式布局
- **默认 50/50**：初始状态平衡，适合大多数场景
- **持久化（待实现）**：v0.2.0 计划添加 localStorage 记忆布局

---

## 🎯 使用场景示例

### 场景 1：新手学习简谱
1. 点击「❓ 帮助」查看语法规则
2. 按照「快速入门」章节，输入第一个音符
3. 在「完整语法规则」中查找具体符号含义
4. 参考「完整示例」编写自己的曲谱

### 场景 2：编写长篇曲谱
1. 拖动分隔线，扩大编辑器宽度（如 70%）
2. 在更宽的编辑区域输入多行简谱
3. 偶尔切换到预览查看效果
4. 播放验证节奏和音高

### 场景 3：调试复杂节奏
1. 拖动分隔线，扩大预览面板（如 70%）
2. 查看 SVG 渲染的音符位置
3. 在编辑器中微调下划线和延长线
4. 实时观察预览面板变化

---

## 📊 功能对比

### 帮助文档

| 特性 | v0.1.0 | v0.1.1 |
|------|--------|--------|
| 查看说明 | ❌ 需打开外部文档 | ✅ 应用内弹窗 |
| 学习成本 | 🔴 高（需切换窗口） | 🟢 低（一键查看） |
| 移动端支持 | ❌ 体验差 | ✅ 响应式设计 |
| 语法查找 | 🔴 需全局搜索 | 🟢 分段落组织 |

### 可拖动布局

| 特性 | v0.1.0 | v0.1.1 |
|------|--------|--------|
| 布局调整 | ❌ 固定 50/50 | ✅ 可拖动调整 |
| 个性化 | ❌ 无法自定义 | ✅ 自由配置 |
| 视觉反馈 | ➖ 无 | ✅ 悬停高亮 |
| 最小宽度 | ➖ 无限制 | ✅ 300px 保护 |

---

## 🛠️ 技术细节

### 帮助模态框组件结构

```tsx
<HelpModal>
  <Header>
    <Title>📖 简谱源码编写说明</Title>
    <CloseButton />
  </Header>
  
  <Content>
    <Section name="快速入门" />
    <Section name="完整语法规则" />
    <Section name="完整示例" />
    <Section name="常见问题" />
  </Content>
  
  <Footer>
    <Link to="docs/user-guide/notation-syntax.md" />
    <ConfirmButton>知道了</ConfirmButton>
  </Footer>
</HelpModal>
```

### 可拖动分隔线组件结构

```tsx
<ResizablePanels>
  <LeftPanel width={leftWidth + '%'}>
    <Editor />
  </LeftPanel>
  
  <Divider
    onMouseDown={startDrag}
    className={isDragging ? 'active' : ''}
  >
    <HoverIndicator />
  </Divider>
  
  <RightPanel width={(100 - leftWidth) + '%'}>
    <ScoreView />
  </RightPanel>
</ResizablePanels>
```

---

## 🔮 未来改进方向

### 帮助文档
- [ ] **搜索功能**：快速定位关键字
- [ ] **代码片段复制**：一键复制示例代码
- [ ] **交互式教程**：边学边练
- [ ] **多语言支持**：英文版本

### 可拖动布局
- [ ] **布局记忆**：localStorage 持久化
- [ ] **双击重置**：快速恢复 50/50
- [ ] **预设布局**：一键切换常用比例
- [ ] **键盘快捷键**：Ctrl+[ / Ctrl+] 调整宽度

---

## 📝 开发日志

### 2026-02-07 - v0.1.1 开发

**产品需求**（产品经理）：
1. 输出简谱源码编写说明文档
2. 在页面上提供查看入口
3. 增加可拖动分隔线交互

**技术实现**（开发工程师）：
1. 创建 `docs/user-guide/notation-syntax.md` 完整文档
2. 实现 `HelpModal.tsx` 组件
3. 实现 `ResizablePanels.tsx` 组件
4. 集成到 `App.tsx` 和 `AppLayout.tsx`
5. 更新 `README.md` 和 `CHANGELOG.md`

**测试验证**（QA工程师）：
- ✅ 帮助按钮点击正常
- ✅ 模态框显示/隐藏正常
- ✅ 分隔线拖动流畅
- ✅ 最小宽度限制生效
- ✅ 响应式布局正常
- ✅ 无控制台错误

**构建状态**：
```bash
pnpm --filter @hh-jianpu/web dev
✅ Vite 启动成功 (113ms)
🌐 http://localhost:5174
```

---

## 🎓 学习资源

### 相关文档
- [产品设计文档](../production/02-product-design.md)
- [技术架构文档](../architecture/01-technical-architecture.md)
- [简谱编写说明](../user-guide/notation-syntax.md)

### 参考资料
- [React Hooks 最佳实践](https://react.dev/reference/react)
- [拖拽交互设计](https://www.nngroup.com/articles/drag-drop/)
- [模态框可访问性](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/)

---

**文档创建时间**: 2026年2月7日  
**作者**: hh-jianpu 产品团队
